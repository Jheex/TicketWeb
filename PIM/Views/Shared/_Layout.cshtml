@* ========================================================= *@
@* Views/Shared/_Layout.cshtml                                *@
@* Layout principal do sistema, responsável por carregar     *@
@* header, footer, body e modais comuns (como logout).       *@
@* ========================================================= *@

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    @* Título dinâmico da página + sufixo "PIM" *@
    <title>@ViewData["Title"] - PIM</title>
    
    @* ========================================================= *@
    @* LINKS DE CSS                                             *@
    @* ========================================================= *@
    
    @* Bootstrap base *@
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    
    @* Bootstrap Icons *@
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    @* CSS principal do site *@
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    
    @* Estilos customizados adicionais *@
    <link rel="stylesheet" href="~/PIM.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/header.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/logout.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/footer.css" asp-append-version="true" />
    
    @* Font Awesome *@
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    
    @* Feedback notifications *@
    <link rel="stylesheet" href="~/css/feedback-styles.css" asp-append-version="true" />
    
    @* Dashboard e outros estilos específicos *@
    <link rel="stylesheet" href="~/css/Dashboard-styles.css" asp-append-version="true" />
    
    @* CSS específico para modal de logout (isolado) *@
    <link rel="stylesheet" href="~/css/modal-logout.css" asp-append-version="true" />
    
    @* Seções de CSS adicionais vindas de Views específicas *@
    @await RenderSectionAsync("Styles", required: false)
</head>

<body class="d-flex flex-column min-vh-100">
    @* ========================================================= *@
    @* HEADER                                                   *@
    @* ========================================================= *@
    <header>
        @* Partial do Header, que contém navbar e ícones do usuário *@
        @await Html.PartialAsync("_Header")
    </header>

    @* ========================================================= *@
    @* CONTEÚDO PRINCIPAL                                      *@
    @* ========================================================= *@
    <main role="main" class="flex-grow-1 container pb-3">
        @RenderBody() @* Aqui é renderizado o conteúdo de cada view *@
    </main>

    @* ========================================================= *@
    @* FOOTER                                                   *@
    @* ========================================================= *@
    <footer class="footer">
        @await Html.PartialAsync("_Footer")
    </footer>
    
    @* ========================================================= *@
    @* MODAL DE LOGOUT                                         *@
    @* ========================================================= *@
    <div class="modal fade" id="confirmLogoutModal" tabindex="-1" aria-labelledby="confirmLogoutModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            
            @* Customização da aparência do modal com CSS isolado *@
            <div class="modal-content modal-logout-custom">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmLogoutModalLabel">
                        <i class="fa-solid fa-triangle-exclamation text-warning me-2"></i>
                        Confirmação de Saída
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Você tem certeza que deseja encerrar sua sessão no sistema?
                </div>
                
                @* Formulário seguro para logout via POST (evita logout via GET) *@
                <form asp-controller="Account" asp-action="Logout" method="post">
                    @Html.AntiForgeryToken() @* Protege contra CSRF *@
                    <div class="modal-footer">
                        @* Botão cancelar fecha o modal *@
                        <button type="button" class="btn btn-secondary btn-cancel-logout" data-bs-dismiss="modal">
                            Ficar
                        </button>
                        @* Botão de confirmar envia o formulário para Logout *@
                        <button type="submit" class="btn btn-danger btn-confirm-logout">
                            Sair
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    @* ========================================================= *@
    @* SCRIPTS                                                 *@
    @* ========================================================= *@
    
    @* jQuery (necessário para alguns plugins e Bootstrap) *@
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    
    @* Bootstrap JS bundle com Popper *@
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    
    @* Scripts customizados do site e do header *@
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/header.js" asp-append-version="true"></script>

    @* ========================================================= *@
    @* FEEDBACK NOTIFICATIONS                                   *@
    @* ========================================================= *@
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="feedback-notification success">
            <i class="fa-solid fa-circle-check"></i>
            <span>@TempData["SuccessMessage"]</span>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="feedback-notification error">
            <i class="fa-solid fa-circle-xmark"></i>
            <span>@TempData["ErrorMessage"]</span>
        </div>
    }

    @* Seções de Scripts adicionais vindas de Views específicas *@
    @await RenderSectionAsync("Scripts", required: false)
    
    @* Toast global para notificações dinâmicas via JS *@
    <div id="toast" class="toast"></div>
</body>
</html>
